// ê¸°ë³¸ ì½˜í…ì¸  ë¡œë“œ
function loadContent() {
    const savedContent = localStorage.getItem('versatifyContent');
    if (savedContent) {
        document.getElementById('toolsContent').innerHTML = savedContent;
    } else {
        loadDefaultContent();
    }
}

function loadDefaultContent() {
    const defaultContent = `
        <div class="tool-category">
            <div class="category-header">
                <div class="category-icon pdf-icon">ğŸ </div>
                <div>
                    <div class="category-title">HUB</div>
                    <div class="category-desc">í†µí•© ì¡°ì‘ ì„¼í„°</div>
                </div>
            </div>
            <div class="tool-list">
                <div class="tool-item" onclick="showFileConverter()">
                    <div class="tool-name">íŒŒì¼ ë³€í™˜</div>
                    <div class="tool-desc">ëª¨ë“  í˜•ì‹ ì§€ì›</div>
                </div>
                <div class="tool-item" onclick="openTool('batch-process')">
                    <div class="tool-name">ì¼ê´„ ì²˜ë¦¬</div>
                    <div class="tool-desc">ì—¬ëŸ¬ ì‘ì—… ë™ì‹œ</div>
                </div>
            </div>
        </div>
        
        <div class="tool-category">
            <div class="category-header">
                <div class="category-icon image-icon">ğŸ“‹</div>
                <div>
                    <div class="category-title">INDEX</div>
                    <div class="category-desc">ì§€ì‹ ê²€ìƒ‰ í—ˆë¸Œ</div>
                </div>
            </div>
            <div class="tool-list">
                <div class="tool-item" onclick="openTool('search')">
                    <div class="tool-name">FLOWS ê²€ìƒ‰</div>
                    <div class="tool-desc">ë„êµ¬ ë¹ ë¥¸ ê²€ìƒ‰</div>
                </div>
                <div class="tool-item" onclick="openTool('categories')">
                    <div class="tool-name">ì¹´í…Œê³ ë¦¬</div>
                    <div class="tool-desc">ì²´ê³„ì  ë¶„ë¥˜</div>
                </div>
            </div>
        </div>
    `;
    document.getElementById('toolsContent').innerHTML = defaultContent;
}

// Tab ì „í™˜
function showTab(tabName) {
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
    });
    document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('active');
    });
    document.getElementById(tabName).classList.add('active');
    event.target.classList.add('active');
}

// ë„êµ¬ ì—´ê¸°
function openTool(toolName) {
    alert(`${toolName} ë„êµ¬ë¥¼ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤!`);
}

// íŒŒì¼ ë³€í™˜ ëª¨ë‹¬
function showFileConverter() {
    document.getElementById('converterModal').classList.add('show');
}

function closeConverterModal() {
    document.getElementById('converterModal').classList.remove('show');
}

// ê´€ë¦¬ì ëª¨ë‹¬
function showAdminModal() {
    document.getElementById('adminModal').classList.add('show');
}

function closeAdminModal() {
    document.getElementById('adminModal').classList.remove('show');
    document.getElementById('adminPassword').value = '';
    document.getElementById('errorMessage').style.display = 'none';
}

function checkAdminPassword() {
    const password = document.getElementById('adminPassword').value;
    if (password === '1234') {
        sessionStorage.setItem('adminLoggedIn', 'true');
        window.location.href = 'admin.html';
    } else {
        document.getElementById('errorMessage').style.display = 'block';
    }
}

// íŒŒì¼ ë³€í™˜ ë°ëª¨
let selectedFile = null;

document.getElementById('fileInput')?.addEventListener('change', function(e) {
    selectedFile = e.target.files[0];
    if (selectedFile) {
        document.getElementById('dropZoneText').textContent = `ì„ íƒëœ íŒŒì¼: ${selectedFile.name}`;
        checkConversionReady();
    }
});

document.getElementById('targetFormat')?.addEventListener('change', checkConversionReady);

function checkConversionReady() {
    const hasFile = selectedFile !== null;
    const hasFormat = document.getElementById('targetFormat').value !== '';
    document.getElementById('convertButton').disabled = !(hasFile && hasFormat);
}

function startConversion() {
    document.getElementById('progressSection').style.display = 'block';
    let progress = 0;
    const interval = setInterval(() => {
        progress += 10;
        document.getElementById('progressFill').style.width = `${progress}%`;
        document.getElementById('statusMessage').textContent = `ë³€í™˜ ì¤‘... ${progress}%`;
        
        if (progress >= 100) {
            clearInterval(interval);
            document.getElementById('statusMessage').textContent = 'ë³€í™˜ ì™„ë£Œ! (ë°ëª¨ ëª¨ë“œ)';
        }
    }, 200);
}

// ì´ˆê¸°í™”
window.onload = function() {
    loadContent();
};
